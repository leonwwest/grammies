// Multi-Language System for Grammar Games
// Supports German and Chinese with localStorage persistence

class LanguageSystem {
    constructor() {
        this.currentLanguage = this.loadLanguage();
        this.translations = this.getTranslations();
        this.initializeLanguageSystem();
    }

    loadLanguage() {
        // Check URL parameter first
        const urlParams = new URLSearchParams(window.location.search);
        const langParam = urlParams.get('lang');
        if (langParam && ['de', 'en', 'zh'].includes(langParam)) {
            localStorage.setItem('grammarGamesLanguage', langParam);
            return langParam;
        }

        // Check localStorage
        const stored = localStorage.getItem('grammarGamesLanguage');
        if (stored && ['de', 'en', 'zh'].includes(stored)) {
            return stored;
        }

        // Default to German
        return 'de';
    }

    saveLanguage(lang) {
        localStorage.setItem('grammarGamesLanguage', lang);
        this.currentLanguage = lang;
    }

    getTranslations() {
        return {
            // German translations
            de: {
                // Meta data
                pageTitle: 'Grammar Games - 10-Min Grammatik f√ºr Kinder',
                
                // Language Selector
                languageLabel: 'Sprache',
                languages: {
                    de: 'Deutsch',
                    zh: '‰∏≠Êñá'
                },

                // Navigation
                backButton: '‚Üê Zur√ºck',
                
                // Variants
                variantA: 'Variante A: 10-Min Games',
                variantB: 'Variante B: Multisensory Grammar',

                // Hero Section (index.html)
                ageRange: 'F√ºr Kinder 4-10 Jahre',
                heroHeadlineA: '10-Minuten Grammatik-Games',
                heroHeadlineB: 'Multisensorische Grammatik f√ºr zu Hause',
                heroSublineA: 'Spielerisch, multisensorisch, kurz und strukturiert - Grammatik lernen war noch nie so einfach!',
                heroSublineB: 'Interaktive Lernmethoden f√ºr eine ganzheitliche Sprachentwicklung Ihres Kindes!',
                
                // Value Props
                playful: 'Spielerisch',
                multisensory: 'Multisensorisch',
                timeLimit: 'Nur 10 Minuten',
                structured: 'Strukturiert',
                
                // Buttons
                viewExampleGames: 'Beispiel-Games ansehen',
                
                // Preview Section (preview.html)
                previewTitle: 'So funktionieren unsere Grammar Games',
                previewSubtitle: 'Printable Karten mit einfachen Routinen f√ºr zu Hause',
                
                // Game examples
                characterWordGame: 'üéØ Charakter-Wortarten-Spiel',
                characterSentenceGame: 'üèóÔ∏è Charakter-S√§tze-Spiel',
                
                // Game elements
                learningFriends: 'üåü Unsere Lern-Freunde helfen beim Sortieren!',
                charactersBuilding: 'üé≠ Die Charaktere bauen einen Satz!',
                perfectSentence: '‚ú® "I play games!" ‚ú®',
                sentenceStructure: 'üëß Pronoun + üéÆ Verb + üé≤ Noun = Perfect Sentence!',
                
                // Routine steps
                miniRoutine: 'üîÑ Mini-Routine (5 Schritte):',
                step1: 'Karten mischen',
                step2: 'Ein Wort vorlesen',
                step3: 'Farbcode erkl√§ren',
                step4: 'Richtige Box finden',
                step5: 'Erfolg feiern! üéâ',
                
                // Word categories (stay in English for grammar learning)
                nouns: 'NOUNS',
                verbs: 'VERBS',
                adjectives: 'ADJECTIVES',
                nounDesc: 'Things & People',
                verbDesc: 'Action Words',
                adjectiveDesc: 'Describing Words',
                
                // Grammar exercise elements (stay in English)
                grammarGame1: 'Grammar Game #1',
                nounVerbAdj: 'Noun ‚Ä¢ Verb ‚Ä¢ Adjective',
                perfectSentence: '‚ú® "I play games!" ‚ú®',
                sentenceStructure: 'üëß Pronoun + üéÆ Verb + üé≤ Noun = Perfect Sentence!',
                
                // Analytics labels
                currentVariant: 'Aktuelle Variante:',
                pageViews: 'Page Views:',
                nextScreen: 'N√§chster Screen:',
                targetCTR: 'Ziel-CTR:',
                targetCTRValue: '‚Üí Games ansehen',
                journeyComplete: 'üèÜ Journey Complete:',
                emailSubmitted: '‚úì Email Submitted',
                hypothesisFulfilled: 'Hypothese erf√ºllt:',
                testing: 'Testend...',
                actions: 'Actions:',
                
                // Age Chooser (chooser.html)
                ageQuestion: 'Wie alt ist Ihr Kind?',
                ageSubtitle: 'Wir zeigen Ihnen die passenden Grammar Games',
                
                age46: '4-6 Jahre',
                age46Desc: 'Spielerische Grundlagen',
                age46Examples: 'Beispiel-Spiele:',
                age46Game1: 'üê± Tier-W√∂rter sortieren',
                age46Game2: 'üåà Farben-Adjektive',
                age46Game3: 'üèÉ‚Äç‚ôÇÔ∏è Action-Verben',
                
                age710: '7-10 Jahre',
                age710Desc: 'Strukturierte Grammatik',
                age710Examples: 'Beispiel-Spiele:',
                age710Game1: 'üìù S√§tze konstruieren',
                age710Game2: '‚ö° Zeit-Formen-Quiz',
                age710Game3: 'üî§ Wortarten-Memory',
                
                // Feedback
                perfect: '‚úì Perfekt!',
                ageSelected: 'Altersgruppe ausgew√§hlt',
                redirecting: 'Leite Sie weiter zu personalisierten Inhalten...',
                ageSpecificText: 'Super! Wir haben passende Spiele f√ºr {age}-J√§hrige zusammengestellt.',
                
                // Next buttons
                suitableGames: 'Passende Spiele f√ºr mein Kind',
                
                // Email Capture (capture.html)
                freeStarterPack: 'Kostenloses Starter-Pack erhalten',
                starterPackDesc: '3 sofort einsetzbare Grammar Games + Anleitung per E-Mail',
                personalPack: 'Ihr pers√∂nliches Starter-Pack:',
                
                // Pack contents
                packItem1: '3 Printable Game-Karten',
                packItem2: 'Schritt-f√ºr-Schritt Anleitung',
                packItem3: 'Altersgerechte Schwierigkeit',
                packItem4: 'Je nur 10 Minuten',
                
                // Age-specific packs
                starterPack46: 'Ihr Starter-Pack f√ºr 4-6 Jahre:',
                pack46Item1: 'Tier-W√∂rter Sortier-Spiel',
                pack46Item2: 'Farben-Adjektive Memory',
                pack46Item3: 'Action-Verben Pantomime',
                pack46Item4: 'Eltern-Anleitung (einfach erkl√§rt)',
                
                starterPack710: 'Ihr Starter-Pack f√ºr 7-10 Jahre:',
                pack710Item1: 'S√§tze-Konstruktor Spiel',
                pack710Item2: 'Zeit-Formen-Quiz Karten',
                pack710Item3: 'Wortarten-Memory Advanced',
                pack710Item4: 'Fortgeschrittene Anleitung',
                
                // Form
                emailPlaceholder: 'Ihre E-Mail-Adresse',
                namePlaceholder: 'Ihr Vorname (optional)',
                getStarterPack: 'üéÅ Kostenloses Starter-Pack erhalten',
                
                // Trust indicators
                freeUnbinding: '‚úì Kostenlos & unverbindlich',
                immediateDownload: '‚úì Sofortiger Download',
                noSpam: '‚úì Keine Spam-Mails',
                
                // Thank You (thankyou.html)
                thankYou: 'Vielen Dank!',
                packOnTheWay: 'Ihr Starter-Pack ist unterwegs',
                
                // Confirmation details
                emailSent: 'E-Mail gesendet',
                checkInbox: 'Pr√ºfen Sie Ihren Posteingang (auch Spam-Ordner)',
                immediatelyAvailable: 'Sofort verf√ºgbar',
                pdfReady: 'PDFs direkt zum Ausdrucken',
                getStarted: 'Loslegen',
                gamesReady: 'Spiele f√ºr Ihr Kind bereit',
                gamesReadyAge: 'Spiele f√ºr {age}-J√§hrige bereit',
                
                // Actions
                moreGames: 'Mehr Spiele ansehen',
                startOver: 'Nochmal von vorne',
                
                // Success metrics
                prototypeSuccess: 'üéØ Prototype Erfolgreich!',
                emailSubmitRate: 'Email Submit Rate',
                screenJourney: 'Screen Journey',
                variantTested: 'Variant Tested',
                hypothesisStatus: 'Hypothese-Status: ',
                toTest: 'Zu testen',
                target: 'Ziel: ‚â•8-12% Email Submit Rate',
                
                // Analytics labels
                currentVariant: 'Aktuelle Variante:',
                pageViews: 'Page Views:',
                nextScreen: 'N√§chster Screen:',
                targetCTR: 'Ziel-CTR:',
                journeyComplete: 'üèÜ Journey Complete:',
                emailSubmitted: '‚úì Email Submitted',
                hypothesisFulfilled: 'Hypothese erf√ºllt:',
                testing: 'Testend...',
                actions: 'Actions:',
                
                // Form validation
                validEmailRequired: 'Bitte geben Sie eine g√ºltige E-Mail-Adresse ein.',
                sending: 'üìß Wird gesendet...',

                // Analytics Panel Labels (Age Chooser)
                ageChooserTitle: 'üìä Screen 3: Age Chooser',
                previewToChooserCTR: 'Preview ‚Üí Chooser CTR:',
                nextScreenChooser: 'N√§chster Screen:',
                conversionGoal: 'Conversion-Ziel:',
                ageSelection: 'Altersauswahl',
                segmentation: 'Segmentierung:',
                ageSegmentation: '4-6 vs 7-10',

                // Analytics Panel Labels (Hero)
                heroTitle: 'üìä Screen 1: Hero',
                targetCTR: 'Ziel-CTR:',

                // Analytics Panel Labels (Preview)
                previewAnalyticsTitle: 'üìä Screen 2: Preview',
                heroToPreviewCTR: 'Hero ‚Üí Preview CTR:',
                engagementGoal: 'Engagement-Ziel:',
                gameInterest: 'Game-Interesse',

                // Analytics Panel Labels (Email Capture)
                captureTitle: 'üìä Screen 4: Email Capture',
                chooserToCaptureCTR: 'Chooser ‚Üí Capture CTR:',
                submitGoal: 'üéØ Ziel:',
                submitTarget: '8-12% Submit',
                mainConversion: 'Hauptkonversion:',
                criticalScreen: '‚òÖ Kritischer Screen',

                // Analytics Panel Labels (Thank You)
                thankyouTitle: 'üìä Screen 5: Thank You',
                actions: 'Actions:',
                moreRestart: 'Mehr | Restart',
            },

            // English translations
            en: {
                // Meta data
                pageTitle: 'Grammar Games - 10-Min Grammar for Children',
                
                // Language Selector
                languageLabel: 'Language',
                languages: {
                    de: 'Deutsch',
                    zh: '‰∏≠Êñá'
                },

                // Navigation
                backButton: '‚Üê Back',
                
                // Variants
                variantA: 'Variant A: 10-Min Games',
                variantB: 'Variant B: Multisensory Grammar',

                // Hero Section
                ageRange: 'For Children Ages 4-10',
                heroHeadlineA: '10-Minute Grammar Games',
                heroHeadlineB: 'Multisensory Grammar at Home',
                heroSublineA: 'Playful, multisensory, short and structured - learning grammar has never been so easy!',
                heroSublineB: 'Interactive learning methods for comprehensive language development of your child!',
                
                // Value Props
                playful: 'Playful',
                multisensory: 'Multisensory',
                timeLimit: 'Only 10 Minutes',
                structured: 'Structured',
                
                // Buttons
                viewExampleGames: 'View Sample Games',
                
                // Preview Section
                previewTitle: 'How our Grammar Games work',
                previewSubtitle: 'Printable cards with simple routines for home',
                
                // Game examples
                characterWordGame: 'üéØ Character Word Types Game',
                characterSentenceGame: 'üèóÔ∏è Character Sentence Building Game',
                
                // Game elements
                learningFriends: 'üåü Our learning friends help with sorting!',
                charactersBuilding: 'üé≠ The characters build a sentence!',
                perfectSentence: '‚ú® "I play games!" ‚ú®',
                sentenceStructure: 'üëß Pronoun + üéÆ Verb + üé≤ Noun = Perfect Sentence!',
                
                // Routine steps
                miniRoutine: 'üîÑ Mini-Routine (5 Steps):',
                step1: 'Shuffle cards',
                step2: 'Read a word aloud',
                step3: 'Explain color code',
                step4: 'Find correct box',
                step5: 'Celebrate success! üéâ',
                
                // Word categories
                nouns: 'NOUNS',
                verbs: 'VERBS',
                adjectives: 'ADJECTIVES',
                nounDesc: 'Things & People',
                verbDesc: 'Action Words',
                adjectiveDesc: 'Describing Words',
                
                // Grammar exercise elements (stay in English)
                grammarGame1: 'Grammar Game #1',
                nounVerbAdj: 'Noun ‚Ä¢ Verb ‚Ä¢ Adjective',
                perfectSentence: '‚ú® "I play games!" ‚ú®',
                sentenceStructure: 'üëß Pronoun + üéÆ Verb + üé≤ Noun = Perfect Sentence!',
                
                // Age Chooser
                ageQuestion: 'How old is your child?',
                ageSubtitle: 'We\'ll show you the appropriate Grammar Games',
                
                age46: '4-6 Years',
                age46Desc: 'Playful Foundations',
                age46Examples: 'Example Games:',
                age46Game1: 'üê± Animal Word Sorting',
                age46Game2: 'üåà Color Adjectives',
                age46Game3: 'üèÉ‚Äç‚ôÇÔ∏è Action Verbs',
                
                age710: '7-10 Years',
                age710Desc: 'Structured Grammar',
                age710Examples: 'Example Games:',
                age710Game1: 'üìù Sentence Construction',
                age710Game2: '‚ö° Tense Quiz',
                age710Game3: 'üî§ Word Types Memory',
                
                // Feedback
                perfect: '‚úì Perfect!',
                ageSelected: 'Age group selected',
                redirecting: 'Redirecting you to personalized content...',
                ageSpecificText: 'Great! We have suitable games for {age}-year-olds ready.',
                
                // Next buttons
                suitableGames: 'Suitable Games for My Child',
                
                // Email Capture
                freeStarterPack: 'Get Free Starter Pack',
                starterPackDesc: '3 ready-to-use Grammar Games + Instructions via Email',
                personalPack: 'Your personal Starter Pack:',
                
                // Pack contents
                packItem1: '3 Printable Game Cards',
                packItem2: 'Step-by-Step Instructions',
                packItem3: 'Age-appropriate Difficulty',
                packItem4: 'Only 10 Minutes Each',
                
                // Age-specific packs
                starterPack46: 'Your Starter Pack for 4-6 Years:',
                pack46Item1: 'Animal Words Sorting Game',
                pack46Item2: 'Color Adjectives Memory',
                pack46Item3: 'Action Verbs Pantomime',
                pack46Item4: 'Parent Guide (Simply Explained)',
                
                starterPack710: 'Your Starter Pack for 7-10 Years:',
                pack710Item1: 'Sentence Builder Game',
                pack710Item2: 'Tense Quiz Cards',
                pack710Item3: 'Advanced Word Types Memory',
                pack710Item4: 'Advanced Instructions',
                
                // Form
                emailPlaceholder: 'Your Email Address',
                namePlaceholder: 'Your First Name (optional)',
                getStarterPack: 'üéÅ Get Free Starter Pack',
                
                // Trust indicators
                freeUnbinding: '‚úì Free & Non-binding',
                immediateDownload: '‚úì Immediate Download',
                noSpam: '‚úì No Spam Emails',
                
                // Thank You
                thankYou: 'Thank You!',
                packOnTheWay: 'Your Starter Pack is on the way',
                
                // Confirmation details
                emailSent: 'Email Sent',
                checkInbox: 'Check your inbox (including spam folder)',
                immediatelyAvailable: 'Immediately Available',
                pdfReady: 'PDFs ready to print',
                getStarted: 'Get Started',
                gamesReady: 'Games ready for your child',
                gamesReadyAge: 'Games for {age}-year-olds ready',
                
                // Actions
                moreGames: 'View More Games',
                startOver: 'Start Over',
                
                // Success metrics
                prototypeSuccess: 'üéØ Prototype Successful!',
                emailSubmitRate: 'Email Submit Rate',
                screenJourney: 'Screen Journey',
                variantTested: 'Variant Tested',
                hypothesisStatus: 'Hypothesis Status: ',
                toTest: 'To Test',
                target: 'Target: ‚â•8-12% Email Submit Rate',
                
                // Analytics labels
                currentVariant: 'Current Variant:',
                pageViews: 'Page Views:',
                nextScreen: 'Next Screen:',
                targetCTR: 'Target CTR:',
                targetCTRValue: '‚Üí View Games',
                journeyComplete: 'üèÜ Journey Complete:',
                emailSubmitted: '‚úì Email Submitted',
                hypothesisFulfilled: 'Hypothesis Fulfilled:',
                testing: 'Testing...',
                actions: 'Actions:',
                
                // Form validation
                validEmailRequired: 'Please enter a valid email address.',
                sending: 'üìß Sending...',

                // Analytics Panel Labels (Age Chooser)
                ageChooserTitle: 'üìä Screen 3: Age Chooser',
                previewToChooserCTR: 'Preview ‚Üí Chooser CTR:',
                nextScreenChooser: 'Next Screen:',
                conversionGoal: 'Conversion Goal:',
                ageSelection: 'Age Selection',
                segmentation: 'Segmentation:',
                ageSegmentation: '4-6 vs 7-10',

                // Analytics Panel Labels (Hero)
                heroTitle: 'üìä Screen 1: Hero',
                targetCTR: 'Target CTR:',

                // Analytics Panel Labels (Preview)
                previewAnalyticsTitle: 'üìä Screen 2: Preview',
                heroToPreviewCTR: 'Hero ‚Üí Preview CTR:',
                engagementGoal: 'Engagement Goal:',
                gameInterest: 'Game Interest',

                // Analytics Panel Labels (Email Capture)
                captureTitle: 'üìä Screen 4: Email Capture',
                chooserToCaptureCTR: 'Chooser ‚Üí Capture CTR:',
                submitGoal: 'üéØ Goal:',
                submitTarget: '8-12% Submit',
                mainConversion: 'Main Conversion:',
                criticalScreen: '‚òÖ Critical Screen',

                // Analytics Panel Labels (Thank You)
                thankyouTitle: 'üìä Screen 5: Thank You',
                actions: 'Actions:',
                moreRestart: 'More | Restart',

                // Hypothesis Status Messages
                hypothesisExcellent: 'üéâ Excellent! ({rate}%)',
                hypothesisConfirmed: '‚úÖ Hypothesis Confirmed! ({rate}%)',
                hypothesisBelow: 'üìä Below Target ({rate}%)',

                // JavaScript Alert/Confirm Messages
                moreGamesFeature: 'üéÆ More Games Feature!\n\nIn the real application:\n‚Ä¢ Additional Game Packages\n‚Ä¢ Premium Content\n‚Ä¢ Age-specific Recommendations\n‚Ä¢ Community Features\n\nThis would lead to an extended catalog.',
                restartJourneyConfirm: 'üîÑ Restart Journey?\n\nThis will:\n‚Ä¢ Reset Analytics\n‚Ä¢ Start a new session\n‚Ä¢ Return to Hero Screen\n\nContinue?',
                additionalGamesMessage: 'üéÆ More games would be shown here...\n\nIn the real app:\n‚Ä¢ Additional Game Packages\n‚Ä¢ Premium Content\n‚Ä¢ Personalized Recommendations',
            },

            // Chinese translations
            zh: {
                // Meta data
                pageTitle: 'Grammar Games - ÂÑøÁ´•10ÂàÜÈíüËØ≠Ê≥ïÂ≠¶‰π†',
                
                // Language Selector
                languageLabel: 'ËØ≠Ë®Ä',
                languages: {
                    de: 'Deutsch',
                    zh: '‰∏≠Êñá'
                },

                // Navigation
                backButton: '‚Üê ËøîÂõû',
                
                // Variants
                variantA: 'ÈÄâÈ°πA: 10ÂàÜÈíüÊ∏∏Êàè',
                variantB: 'ÈÄâÈ°πB: Â§öÊÑüÂÆòËØ≠Ê≥ï',

                // Hero Section
                ageRange: 'ÈÄÇÂêà4-10Â≤ÅÂÑøÁ´•',
                heroHeadlineA: '10ÂàÜÈíüËØ≠Ê≥ïÊ∏∏Êàè',
                heroHeadlineB: 'ÂÆ∂Â∫≠Â§öÊÑüÂÆòËØ≠Ê≥ïÂ≠¶‰π†',
                heroSublineA: 'Ê∏∏ÊàèÂåñ„ÄÅÂ§öÊÑüÂÆò„ÄÅÁÆÄÁü≠‰∏îÁªìÊûÑÂåñ - ËØ≠Ê≥ïÂ≠¶‰π†‰ªéÊú™Â¶ÇÊ≠§ÁÆÄÂçïÔºÅ',
                heroSublineB: '‰∫íÂä®Â≠¶‰π†ÊñπÊ≥ïÔºåÂÖ®Èù¢ÊèêÈ´òÊÇ®Â≠©Â≠êÁöÑËØ≠Ë®ÄÂèëÂ±ïÔºÅ',
                
                // Value Props
                playful: 'Ê∏∏ÊàèÂåñ',
                multisensory: 'Â§öÊÑüÂÆò',
                timeLimit: '‰ªÖÈúÄ10ÂàÜÈíü',
                structured: 'ÁªìÊûÑÂåñ',
                
                // Buttons
                viewExampleGames: 'Êü•ÁúãÁ§∫‰æãÊ∏∏Êàè',
                
                // Preview Section
                previewTitle: 'Êàë‰ª¨ÁöÑËØ≠Ê≥ïÊ∏∏ÊàèÂ¶Ç‰ΩïËøê‰Ωú',
                previewSubtitle: 'ÂÆ∂Â∫≠‰ΩøÁî®ÁöÑÂèØÊâìÂç∞Âç°ÁâáÂíåÁÆÄÂçïÁ®ãÂ∫è',
                
                // Game examples
                characterWordGame: 'üéØ ËßíËâ≤ËØçÊ±áÂàÜÁ±ªÊ∏∏Êàè',
                characterSentenceGame: 'üèóÔ∏è ËßíËâ≤ÈÄ†Âè•Ê∏∏Êàè',
                
                // Game elements
                learningFriends: 'üåü Êàë‰ª¨ÁöÑÂ≠¶‰π†‰ºô‰º¥Â∏ÆÂä©ÂàÜÁ±ªÔºÅ',
                charactersBuilding: 'üé≠ ËßíËâ≤‰ª¨Ê≠£Âú®ÈÄ†Âè•ÔºÅ',
                perfectSentence: '‚ú® "I play games!" ‚ú®',
                sentenceStructure: 'üëß ‰ª£ËØç + üéÆ Âä®ËØç + üé≤ ÂêçËØç = ÂÆåÁæéÂè•Â≠êÔºÅ',
                
                // Routine steps
                miniRoutine: 'üîÑ Ëø∑‰Ω†ÁªÉ‰π† (5Ê≠•)Ôºö',
                step1: 'Ê¥óÁâå',
                step2: 'Â§ßÂ£∞ËØªÂçïËØç',
                step3: 'Ëß£ÈáäÈ¢úËâ≤‰ª£Á†Å',
                step4: 'ÊâæÂà∞Ê≠£Á°ÆÁöÑÁõíÂ≠ê',
                step5: 'Â∫ÜÁ•ùÊàêÂäüÔºÅüéâ',
                
                // Word categories
                nouns: 'NOUNS',
                verbs: 'VERBS',
                adjectives: 'ADJECTIVES',
                nounDesc: 'Things & People',
                verbDesc: 'Action Words',
                adjectiveDesc: 'Describing Words',
                
                // Grammar exercise elements (stay in English)
                grammarGame1: 'Grammar Game #1',
                nounVerbAdj: 'Noun ‚Ä¢ Verb ‚Ä¢ Adjective',
                perfectSentence: '‚ú® "I play games!" ‚ú®',
                sentenceStructure: 'üëß Pronoun + üéÆ Verb + üé≤ Noun = Perfect Sentence!',
                
                // Age Chooser
                ageQuestion: 'ÊÇ®ÁöÑÂ≠©Â≠êÂá†Â≤ÅÔºü',
                ageSubtitle: 'Êàë‰ª¨Â∞Ü‰∏∫ÊÇ®Â±ïÁ§∫ÈÄÇÂêàÁöÑËØ≠Ê≥ïÊ∏∏Êàè',
                
                age46: '4-6Â≤Å',
                age46Desc: 'Ê∏∏ÊàèÂåñÂü∫Á°Ä',
                age46Examples: 'Á§∫‰æãÊ∏∏ÊàèÔºö',
                age46Game1: 'üê± Âä®Áâ©ÂçïËØçÂàÜÁ±ª',
                age46Game2: 'üåà È¢úËâ≤ÂΩ¢ÂÆπËØç',
                age46Game3: 'üèÉ‚Äç‚ôÇÔ∏è Âä®‰ΩúÂä®ËØç',
                
                age710: '7-10Â≤Å',
                age710Desc: 'ÁªìÊûÑÂåñËØ≠Ê≥ï',
                age710Examples: 'Á§∫‰æãÊ∏∏ÊàèÔºö',
                age710Game1: 'üìù Âè•Â≠êÊûÑÈÄ†',
                age710Game2: '‚ö° Êó∂ÊÄÅÊµãÈ™å',
                age710Game3: 'üî§ ËØçÊ±áÂàÜÁ±ªËÆ∞ÂøÜ',
                
                // Feedback
                perfect: '‚úì ÂÆåÁæéÔºÅ',
                ageSelected: 'Âπ¥ÈæÑÁªÑÂ∑≤ÈÄâÊã©',
                redirecting: 'Ê≠£Âú®‰∏∫ÊÇ®Ë∑≥ËΩ¨Âà∞‰∏™ÊÄßÂåñÂÜÖÂÆπ...',
                ageSpecificText: 'Â§™Â•Ω‰∫ÜÔºÅÊàë‰ª¨‰∏∫{age}Â≤ÅÁöÑÂ≠©Â≠êÂáÜÂ§á‰∫ÜÂêàÈÄÇÁöÑÊ∏∏Êàè„ÄÇ',
                
                // Next buttons
                suitableGames: 'ÈÄÇÂêàÊàëÂ≠©Â≠êÁöÑÊ∏∏Êàè',
                
                // Email Capture
                freeStarterPack: 'Ëé∑ÂèñÂÖçË¥πÂÖ•Èó®ÂåÖ',
                starterPackDesc: '3‰∏™Âç≥Áî®ËØ≠Ê≥ïÊ∏∏Êàè + ÈÇÆ‰ª∂ÊåáÂØº',
                personalPack: 'ÊÇ®ÁöÑ‰∏™‰∫∫ÂÖ•Èó®ÂåÖÔºö',
                
                // Pack contents
                packItem1: '3Âº†ÂèØÊâìÂç∞Ê∏∏ÊàèÂç°',
                packItem2: 'ÂàÜÊ≠•ÊåáÂØºËØ¥Êòé',
                packItem3: 'ÈÄÇÈæÑÈöæÂ∫¶',
                packItem4: 'ÊØè‰∏™‰ªÖÈúÄ10ÂàÜÈíü',
                
                // Age-specific packs
                starterPack46: 'ÊÇ®ÁöÑ4-6Â≤ÅÂÖ•Èó®ÂåÖÔºö',
                pack46Item1: 'Âä®Áâ©ËØçÊ±áÂàÜÁ±ªÊ∏∏Êàè',
                pack46Item2: 'È¢úËâ≤ÂΩ¢ÂÆπËØçËÆ∞ÂøÜ',
                pack46Item3: 'Âä®‰ΩúÂä®ËØçË°®Êºî',
                pack46Item4: 'ÂÆ∂ÈïøÊåáÂçóÔºàÁÆÄÂçïËß£ÈáäÔºâ',
                
                starterPack710: 'ÊÇ®ÁöÑ7-10Â≤ÅÂÖ•Èó®ÂåÖÔºö',
                pack710Item1: 'Âè•Â≠êÊûÑÈÄ†Âô®Ê∏∏Êàè',
                pack710Item2: 'Êó∂ÊÄÅÊµãÈ™åÂç°',
                pack710Item3: 'È´òÁ∫ßËØçÊ±áÂàÜÁ±ªËÆ∞ÂøÜ',
                pack710Item4: 'ËøõÈò∂ÊåáÂØº',
                
                // Form
                emailPlaceholder: 'ÊÇ®ÁöÑÈÇÆÁÆ±Âú∞ÂùÄ',
                namePlaceholder: 'ÊÇ®ÁöÑÂêçÂ≠óÔºàÂèØÈÄâÔºâ',
                getStarterPack: 'üéÅ Ëé∑ÂèñÂÖçË¥πÂÖ•Èó®ÂåÖ',
                
                // Trust indicators
                freeUnbinding: '‚úì ÂÖçË¥π‰∏îÊó†Á∫¶Êùü',
                immediateDownload: '‚úì Á´ãÂç≥‰∏ãËΩΩ',
                noSpam: '‚úì Êó†ÂûÉÂúæÈÇÆ‰ª∂',
                
                // Thank You
                thankYou: 'Ë∞¢Ë∞¢ÊÇ®ÔºÅ',
                packOnTheWay: 'ÊÇ®ÁöÑÂÖ•Èó®ÂåÖÊ≠£Âú®Ë∑Ø‰∏ä',
                
                // Confirmation details
                emailSent: 'ÈÇÆ‰ª∂Â∑≤ÂèëÈÄÅ',
                checkInbox: 'ËØ∑Ê£ÄÊü•ÊÇ®ÁöÑÊî∂‰ª∂ÁÆ±ÔºàÂåÖÊã¨ÂûÉÂúæÈÇÆ‰ª∂Êñá‰ª∂Â§πÔºâ',
                immediatelyAvailable: 'Á´ãÂç≥ÂèØÁî®',
                pdfReady: 'ÂèØÁõ¥Êé•ÊâìÂç∞ÁöÑPDF',
                getStarted: 'ÂºÄÂßã',
                gamesReady: '‰∏∫ÊÇ®ÁöÑÂ≠©Â≠êÂáÜÂ§áÁöÑÊ∏∏Êàè',
                gamesReadyAge: '‰∏∫{age}Â≤ÅÂ≠©Â≠êÂáÜÂ§áÁöÑÊ∏∏Êàè',
                
                // Actions
                moreGames: 'Êü•ÁúãÊõ¥Â§öÊ∏∏Êàè',
                startOver: 'ÈáçÊñ∞ÂºÄÂßã',
                
                // Success metrics
                prototypeSuccess: 'üéØ ÂéüÂûãÊàêÂäüÔºÅ',
                emailSubmitRate: 'ÈÇÆ‰ª∂Êèê‰∫§Áéá',
                screenJourney: 'Â±èÂπïÊóÖÁ®ã',
                variantTested: 'ÊµãËØïÂèò‰Ωì',
                hypothesisStatus: 'ÂÅáËÆæÁä∂ÊÄÅÔºö',
                toTest: 'ÂæÖÊµãËØï',
                target: 'ÁõÆÊ†áÔºö‚â•8-12% ÈÇÆ‰ª∂Êèê‰∫§Áéá',
                
                // Analytics labels
                currentVariant: 'ÂΩìÂâçÂèò‰ΩìÔºö',
                pageViews: 'È°µÈù¢ÊµèËßàÈáèÔºö',
                nextScreen: '‰∏ã‰∏ÄÂ±èÔºö',
                targetCTR: 'ÁõÆÊ†áÁÇπÂáªÁéáÔºö',
                targetCTRValue: '‚Üí Êü•ÁúãÊ∏∏Êàè',
                journeyComplete: 'üèÜ ÊóÖÁ®ãÂÆåÊàêÔºö',
                emailSubmitted: '‚úì ÈÇÆ‰ª∂Â∑≤Êèê‰∫§',
                hypothesisFulfilled: 'ÂÅáËÆæÂÆûÁé∞Ôºö',
                testing: 'ÊµãËØï‰∏≠...',
                actions: 'Êìç‰ΩúÔºö',
                
                // Form validation
                validEmailRequired: 'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈÇÆÁÆ±Âú∞ÂùÄ„ÄÇ',
                sending: 'üìß ÂèëÈÄÅ‰∏≠...',

                // Analytics Panel Labels (Age Chooser)
                ageChooserTitle: 'üìä Â±èÂπï3ÔºöÂπ¥ÈæÑÈÄâÊã©',
                previewToChooserCTR: 'È¢ÑËßà‚ÜíÈÄâÊã©Âô®ÁÇπÂáªÁéáÔºö',
                nextScreenChooser: '‰∏ã‰∏ÄÂ±èÔºö',
                conversionGoal: 'ËΩ¨ÂåñÁõÆÊ†áÔºö',
                ageSelection: 'Âπ¥ÈæÑÈÄâÊã©',
                segmentation: 'ÁªÜÂàÜÔºö',
                ageSegmentation: '4-6Â≤Åvs7-10Â≤Å',

                // Analytics Panel Labels (Hero)
                heroTitle: 'üìä Â±èÂπï1ÔºöËã±ÈõÑ',
                targetCTR: 'ÁõÆÊ†áÁÇπÂáªÁéáÔºö',

                // Analytics Panel Labels (Preview)
                previewAnalyticsTitle: 'üìä Â±èÂπï2ÔºöÈ¢ÑËßà',
                heroToPreviewCTR: 'Ëã±ÈõÑ‚ÜíÈ¢ÑËßàÁÇπÂáªÁéáÔºö',
                engagementGoal: 'ÂèÇ‰∏éÁõÆÊ†áÔºö',
                gameInterest: 'Ê∏∏ÊàèÂÖ¥Ë∂£',

                // Analytics Panel Labels (Email Capture)
                captureTitle: 'üìä Â±èÂπï4ÔºöÈÇÆÁÆ±Êî∂ÈõÜ',
                chooserToCaptureCTR: 'ÈÄâÊã©Âô®‚ÜíÊî∂ÈõÜÁÇπÂáªÁéáÔºö',
                submitGoal: 'üéØ ÁõÆÊ†áÔºö',
                submitTarget: '8-12%Êèê‰∫§',
                mainConversion: '‰∏ªË¶ÅËΩ¨ÂåñÔºö',
                criticalScreen: '‚òÖ ÂÖ≥ÈîÆÂ±èÂπï',

                // Analytics Panel Labels (Thank You)
                thankyouTitle: 'üìä Â±èÂπï5ÔºöË∞¢Ë∞¢',
                actions: 'Êìç‰ΩúÔºö',
                moreRestart: 'Êõ¥Â§ö | ÈáçÊñ∞ÂºÄÂßã',

                // Hypothesis Status Messages
                hypothesisExcellent: 'üéâ Â§™Ê£í‰∫ÜÔºÅ({rate}%)',
                hypothesisConfirmed: '‚úÖ ÂÅáËÆæËØÅÂÆûÔºÅ({rate}%)',
                hypothesisBelow: 'üìä Êú™ËææÁõÆÊ†á ({rate}%)',

                // JavaScript Alert/Confirm Messages
                moreGamesFeature: 'üéÆ Êõ¥Â§öÊ∏∏ÊàèÂäüËÉΩÔºÅ\n\nÂú®ÁúüÂÆûÂ∫îÁî®‰∏≠Ôºö\n‚Ä¢ È¢ùÂ§ñÁöÑÊ∏∏ÊàèÂåÖ\n‚Ä¢ È´òÁ∫ßÂÜÖÂÆπ\n‚Ä¢ ÁâπÂÆöÂπ¥ÈæÑÊÆµÊé®Ëçê\n‚Ä¢ Á§æÂå∫ÂäüËÉΩ\n\nËøôÂ∞ÜÂ∏¶Êù•Êâ©Â±ïÁöÑÁõÆÂΩï„ÄÇ',
                restartJourneyConfirm: 'üîÑ ÈáçÊñ∞ÂºÄÂßãÊóÖÁ®ãÔºü\n\nËøôÂ∞ÜÔºö\n‚Ä¢ ÈáçÁΩÆÂàÜÊûê\n‚Ä¢ ÂºÄÂßãÊñ∞‰ºöËØù\n‚Ä¢ ËøîÂõûËã±ÈõÑÂ±èÂπï\n\nÁªßÁª≠Ôºü',
                additionalGamesMessage: 'üéÆ ËøôÈáå‰ºöÊòæÁ§∫Êõ¥Â§öÊ∏∏Êàè...\n\nÂú®ÁúüÂÆûÂ∫îÁî®‰∏≠Ôºö\n‚Ä¢ È¢ùÂ§ñÁöÑÊ∏∏ÊàèÂåÖ\n‚Ä¢ È´òÁ∫ßÂÜÖÂÆπ\n‚Ä¢ ‰∏™ÊÄßÂåñÊé®Ëçê',
            }
        };
    }

    initializeLanguageSystem() {
        try {
            console.log('üöÄ Initializing Language System...');
            // Remove any existing language selectors first
            const existingSelectors = document.querySelectorAll('.language-selector');
            existingSelectors.forEach(selector => selector.remove());
            
            this.addLanguageSelector();
            this.updatePageContent();
            console.log(`üåç Language system initialized: ${this.currentLanguage}`);
        } catch (error) {
            console.error('‚ùå Error initializing language system:', error);
        }
    }

    addLanguageSelector() {
        const languageSelector = document.createElement('div');
        languageSelector.className = 'language-selector';
        languageSelector.innerHTML = `
            <div class="language-dropdown">
                <button class="language-btn" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'block' ? 'none' : 'block';">
                    üåç ${this.t('languages.' + this.currentLanguage)}
                </button>
                <div class="language-options" style="display: none;">
                    <button onclick="window.languageSystem.changeLanguage('de')" class="${this.currentLanguage === 'de' ? 'active' : ''}">
                        üá©üá™ ${this.t('languages.de')}
                    </button>
                    <button onclick="window.languageSystem.changeLanguage('zh')" class="${this.currentLanguage === 'zh' ? 'active' : ''}">
                        üá®üá≥ ${this.t('languages.zh')}
                    </button>
                </div>
            </div>
        `;

        // Insert language selector into page
        if (document.body) {
            document.body.insertBefore(languageSelector, document.body.firstChild);
        } else {
            document.addEventListener('DOMContentLoaded', () => {
                document.body.insertBefore(languageSelector, document.body.firstChild);
            });
        }
    }

    toggleDropdown() {
        // Simplified version - not needed with inline onclick
        console.log('Toggle dropdown called');
    }

    changeLanguage(lang) {
        console.log('üîÑ changeLanguage called with:', lang);

        // Check if languageSystem exists
        if (!window.languageSystem) {
            console.error('‚ùå window.languageSystem is not available');
            return;
        }

        console.log('Current language:', this.currentLanguage);
        console.log('Available languages:', ['de', 'zh']);
        console.log('Language is valid:', ['de', 'zh'].includes(lang));
        console.log('Language is different:', lang !== this.currentLanguage);

        if (['de', 'zh'].includes(lang) && lang !== this.currentLanguage) {
            console.log('‚úÖ Language change conditions met, proceeding...');

            this.saveLanguage(lang);
            console.log('üíæ Language saved to localStorage');

            // Update URL parameter
            const url = new URL(window.location);
            url.searchParams.set('lang', lang);
            window.history.replaceState(null, '', url);
            console.log('üîó URL updated with lang parameter');

            // Update page content
            console.log('üìù Updating page content...');
            this.updatePageContent();

            // Update dropdown button text
            console.log('üîò Updating dropdown button...');
            this.updateDropdownButton();

            // Close dropdown
            const options = document.querySelector('.language-options');
            if (options) {
                options.style.display = 'none';
                console.log('üìÇ Dropdown closed');
            }

            console.log(`üåç Language changed to: ${lang}`);
            console.log('üéâ Language change completed!');
        } else {
            console.log('‚ùå Language change conditions not met');
        }
    }
    
    updateDropdownButton() {
        const languageBtn = document.querySelector('.language-btn');
        if (languageBtn) {
            languageBtn.innerHTML = `üåç ${this.t('languages.' + this.currentLanguage)}`;
        }

        // Update active state in dropdown options
        document.querySelectorAll('.language-options button').forEach(btn => {
            btn.classList.remove('active');
            if (btn.onclick && btn.onclick.toString().includes(this.currentLanguage)) {
                btn.classList.add('active');
            }
        });
    }

    t(key, params = {}) {
        const keys = key.split('.');
        let value = this.translations[this.currentLanguage];
        
        for (const k of keys) {
            if (value && value[k] !== undefined) {
                value = value[k];
            } else {
                console.warn(`Translation missing for key: ${key} in language: ${this.currentLanguage}`);
                return key;
            }
        }
        
        // Replace parameters
        if (typeof value === 'string') {
            Object.keys(params).forEach(param => {
                value = value.replace(`{${param}}`, params[param]);
            });
        }
        
        return value;
    }

    updatePageContent() {
        // Update document title
        document.title = this.t('pageTitle');

        // Update HTML lang attribute
        document.documentElement.lang = this.currentLanguage === 'zh' ? 'zh-CN' : this.currentLanguage;

        // Update all elements with data-translate attribute
        document.querySelectorAll('[data-translate]').forEach(element => {
            const key = element.getAttribute('data-translate');
            const params = element.getAttribute('data-translate-params');
            const parsedParams = params ? JSON.parse(params) : {};

            element.textContent = this.t(key, parsedParams);
        });

        // Update form placeholders
        const emailInput = document.getElementById('email-input');
        const nameInput = document.getElementById('name-input');
        if (emailInput) emailInput.placeholder = this.t('emailPlaceholder');
        if (nameInput) nameInput.placeholder = this.t('namePlaceholder');

        // Update language selector button
        // Note: This is handled by updateDropdownButton() function, so we don't need to do it here

        // Update dynamic content that doesn't have data-translate attributes
        this.updateDynamicContent();

        // Update variant UI if analytics exists
        if (window.analytics) {
            window.analytics.updateVariantUI(window.analytics.sessionData.variant);
        }
    }

    updateDynamicContent() {
        // Update hero content based on current variant
        const heroHeadline = document.getElementById('hero-headline');
        const heroSubline = document.getElementById('hero-subline');

        if (heroHeadline && heroSubline && window.analytics && window.analytics.sessionData) {
            const variant = window.analytics.sessionData.variant;
            if (variant === 'A') {
                heroHeadline.textContent = this.t('heroHeadlineA');
                heroSubline.textContent = this.t('heroSublineA');
            } else if (variant === 'B') {
                heroHeadline.textContent = this.t('heroHeadlineB');
                heroSubline.textContent = this.t('heroSublineB');
            }
        }

        // Update pack content in capture page if age is selected
        const packTitle = document.getElementById('pack-title');
        const packContents = document.getElementById('pack-contents');

        if (packTitle && packContents && window.analytics && window.analytics.sessionData) {
            const age = window.analytics.sessionData.ageSelected;
            if (age === '4-6') {
                packTitle.textContent = this.t('starterPack46');
                packContents.innerHTML = `
                    <div class="pack-item" style="display: flex; align-items: center; gap: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; margin-bottom: 10px;">
                        <div class="icon" style="font-size: 1.5em; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: linear-gradient(45deg, #FF8A95, #FFB3BA); border-radius: 50%;">üê±</div>
                        <span style="font-weight: 500; color: #2c3e50;">${this.t('pack46Item1')}</span>
                    </div>
                    <div class="pack-item" style="display: flex; align-items: center; gap: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; margin-bottom: 10px;">
                        <div class="icon" style="font-size: 1.5em; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: linear-gradient(45deg, #FF8A95, #FFB3BA); border-radius: 50%;">üåà</div>
                        <span style="font-weight: 500; color: #2c3e50;">${this.t('pack46Item2')}</span>
                    </div>
                    <div class="pack-item" style="display: flex; align-items: center; gap: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; margin-bottom: 10px;">
                        <div class="icon" style="font-size: 1.5em; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: linear-gradient(45deg, #FF8A95, #FFB3BA); border-radius: 50%;">üèÉ‚Äç‚ôÇÔ∏è</div>
                        <span style="font-weight: 500; color: #2c3e50;">${this.t('pack46Item3')}</span>
                    </div>
                    <div class="pack-item" style="display: flex; align-items: center; gap: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                        <div class="icon" style="font-size: 1.5em; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: linear-gradient(45deg, #FF8A95, #FFB3BA); border-radius: 50%;">üìñ</div>
                        <span style="font-weight: 500; color: #2c3e50;">${this.t('pack46Item4')}</span>
                    </div>
                `;
            } else if (age === '7-10') {
                packTitle.textContent = this.t('starterPack710');
                packContents.innerHTML = `
                    <div class="pack-item" style="display: flex; align-items: center; gap: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; margin-bottom: 10px;">
                        <div class="icon" style="font-size: 1.5em; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: linear-gradient(45deg, #FF8A95, #FFB3BA); border-radius: 50%;">üìù</div>
                        <span style="font-weight: 500; color: #2c3e50;">${this.t('pack710Item1')}</span>
                    </div>
                    <div class="pack-item" style="display: flex; align-items: center; gap: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; margin-bottom: 10px;">
                        <div class="icon" style="font-size: 1.5em; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: linear-gradient(45deg, #FF8A95, #FFB3BA); border-radius: 50%;">‚ö°</div>
                        <span style="font-weight: 500; color: #2c3e50;">${this.t('pack710Item2')}</span>
                    </div>
                    <div class="pack-item" style="display: flex; align-items: center; gap: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; margin-bottom: 10px;">
                        <div class="icon" style="font-size: 1.5em; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: linear-gradient(45deg, #FF8A95, #FFB3BA); border-radius: 50%;">üî§</div>
                        <span style="font-weight: 500; color: #2c3e50;">${this.t('pack710Item3')}</span>
                    </div>
                    <div class="pack-item" style="display: flex; align-items: center; gap: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                        <div class="icon" style="font-size: 1.5em; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: linear-gradient(45deg, #FF8A95, #FFB3BA); border-radius: 50%;">üéØ</div>
                        <span style="font-weight: 500; color: #2c3e50;">${this.t('pack710Item4')}</span>
                    </div>
                `;
            }
        }

        // Update age selection text in thankyou page
        const selectedAgeText = document.getElementById('selected-age-text');
        if (selectedAgeText && window.analytics && window.analytics.sessionData) {
            const age = window.analytics.sessionData.ageSelected;
            if (age) {
                selectedAgeText.textContent = this.t('gamesReadyAge', { age: age });
            }
        }

        // Update button texts that might be dynamically changed
        const submitBtn = document.getElementById('submit-btn');
        if (submitBtn && submitBtn.textContent && (submitBtn.textContent === 'üìß Wird gesendet...' || submitBtn.textContent === 'üìß Sending...')) {
            submitBtn.textContent = this.t('sending');
        }

        // Update selection text in chooser
        const selectionText = document.getElementById('selection-text');
        if (selectionText && window.analytics && window.analytics.sessionData) {
            const age = window.analytics.sessionData.ageSelected;
            if (age) {
                selectionText.textContent = this.t('ageSpecificText', { age: age });
            }
        }

        // Update variant buttons specifically
        const variantBtns = document.querySelectorAll('.variant-btn');
        variantBtns.forEach(btn => {
            const translateAttr = btn.getAttribute('data-translate');
            if (translateAttr) {
                btn.textContent = this.t(translateAttr);
            }
        });

        // Update hypothesis status text if it exists
        const hypothesisStatus = document.getElementById('hypothesis-status');
        if (hypothesisStatus && window.analytics && window.analytics.sessionData) {
            const analytics = window.analytics.sessionData;
            const captureViews = analytics.screens.capture || 1;
            const emailSubmits = analytics.clicks.emailSubmit || 0;
            const submitRate = (emailSubmits / captureViews) * 100;

            if (submitRate >= 12) {
                hypothesisStatus.textContent = this.t('hypothesisExcellent', { rate: submitRate.toFixed(1) });
                hypothesisStatus.style.color = '#4CAF50';
            } else if (submitRate >= 8) {
                hypothesisStatus.textContent = this.t('hypothesisConfirmed', { rate: submitRate.toFixed(1) });
                hypothesisStatus.style.color = '#FFC107';
            } else {
                hypothesisStatus.textContent = this.t('hypothesisBelow', { rate: submitRate.toFixed(1) });
                hypothesisStatus.style.color = '#ff6b6b';
            }
        }
    }

    // Utility function for scripts to update specific content
    updateElement(elementId, translationKey, params = {}) {
        const element = document.getElementById(elementId);
        if (element) {
            element.textContent = this.t(translationKey, params);
        }
    }
}

// Global instance - create when DOM is ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üìÑ DOM loaded, creating Language System...');
        window.languageSystem = new LanguageSystem();
        console.log('‚úÖ Language System created successfully');
    });
} else {
    console.log('üìÑ DOM already loaded, creating Language System...');
    window.languageSystem = new LanguageSystem();
    console.log('‚úÖ Language System created successfully');
}

// Close dropdown when clicking outside
document.addEventListener('click', function(event) {
    const dropdown = document.querySelector('.language-dropdown');
    const options = document.getElementById('language-options');
    
    if (dropdown && !dropdown.contains(event.target) && options) {
        options.classList.remove('open');
    }
});
